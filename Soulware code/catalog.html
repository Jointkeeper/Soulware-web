<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞—Ç–∞–ª–æ–≥ —Ç–µ—Å—Ç–æ–≤ ‚Äî Soulware</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="js/lang.js"></script>
  <script defer src="js/auth.js"></script>
</head>
<body class="bg-gray-900 text-white font-sans">

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å (—Ç–∞–∫–∞—è –∂–µ –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π) -->
  <header class="bg-gray-800 border-b border-gray-700 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
      <a href="index.html" class="text-xl font-bold text-purple-400">Soulware</a>
      <nav class="hidden md:flex space-x-6 text-sm">
        <a href="catalog.html" class="hover:text-purple-400 transition-colors">–¢–µ—Å—Ç—ã</a>
        <a href="daily.html" class="hover:text-purple-400 transition-colors">–¢–µ—Å—Ç –¥–Ω—è</a>
        <a href="recommendations.html" class="hover:text-purple-400 transition-colors">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</a>
        <a href="profile.html" class="hover:text-purple-400 transition-colors">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
        <a href="subscribe.html" class="hover:text-purple-400 transition-colors">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
        <button id="auth-button" class="bg-purple-600 hover:bg-purple-700 px-4 py-1 rounded transition-colors">
          –í–æ–π—Ç–∏
        </button>
      </nav>
      <button class="md:hidden text-gray-400 hover:text-white" id="mobile-menu-button">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <div class="md:hidden hidden" id="mobile-menu">
      <div class="px-2 pt-2 pb-3 space-y-1">
        <a href="catalog.html" class="block px-3 py-2 hover:bg-gray-700 rounded">–¢–µ—Å—Ç—ã</a>
        <a href="daily.html" class="block px-3 py-2 hover:bg-gray-700 rounded">–¢–µ—Å—Ç –¥–Ω—è</a>
        <a href="recommendations.html" class="block px-3 py-2 hover:bg-gray-700 rounded">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</a>
        <a href="profile.html" class="block px-3 py-2 hover:bg-gray-700 rounded">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
        <a href="subscribe.html" class="block px-3 py-2 hover:bg-gray-700 rounded">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
      </div>
    </div>
  </header>

  <main class="p-6 max-w-7xl mx-auto">
    <div class="text-center mb-12">
      <h1 class="text-3xl md:text-4xl font-bold text-purple-300 mb-4">–ö–∞—Ç–∞–ª–æ–≥ —Ç–µ—Å—Ç–æ–≤</h1>
      <p class="text-gray-400">–ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å–µ–±—è —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É –º–∏—Ñ–æ–≤, –∞—Ä—Ö–µ—Ç–∏–ø–æ–≤ –∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏</p>
    </div>

    <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <div class="mb-8 space-y-4">
      <!-- –ü–æ–∏—Å–∫ -->
      <div class="relative">
        <input type="text" id="search-input" 
               placeholder="–ü–æ–∏—Å–∫ —Ç–µ—Å—Ç–æ–≤..." 
               class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 pl-10 focus:outline-none focus:border-purple-500">
        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
      </div>

      <!-- –§–∏–ª—å—Ç—Ä—ã -->
      <div class="flex flex-wrap gap-4">
        <div class="flex-1 min-w-[200px]">
          <select id="category-filter" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-purple-500">
            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option value="personality">–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–µ</option>
            <option value="career">–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</option>
            <option value="relationships">–û—Ç–Ω–æ—à–µ–Ω–∏—è</option>
            <option value="emotional">–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç</option>
            <option value="cognitive">–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</option>
            <option value="mental_health">–ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ</option>
            <option value="development">–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç</option>
            <option value="social">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏</option>
            <option value="leadership">–õ–∏–¥–µ—Ä—Å—Ç–≤–æ</option>
            <option value="stress">–°—Ç—Ä–µ—Å—Å –∏ –≤—ã–≥–æ—Ä–∞–Ω–∏–µ</option>
            <option value="creativity">–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å</option>
            <option value="motivation">–ú–æ—Ç–∏–≤–∞—Ü–∏—è</option>
            <option value="values">–¶–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —É–±–µ–∂–¥–µ–Ω–∏—è</option>
            <option value="humor">–Æ–º–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ</option>
            <option value="mythology">–ú–∏—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ</option>
            <option value="scenario">–°—Ü–µ–Ω–∞—Ä–Ω—ã–µ</option>
            <option value="lifestyle">–ó–¥–æ—Ä–æ–≤—å–µ –∏ –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏</option>
            <option value="finance">–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å</option>
            <option value="self_esteem">–°–∞–º–æ–æ—Ü–µ–Ω–∫–∞</option>
            <option value="communication">–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è</option>
            <option value="culture">–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ</option>
            <option value="ethics">–≠—Ç–∏—á–µ—Å–∫–∏–µ –¥–∏–ª–µ–º–º—ã</option>
            <option value="creative_thinking">–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ</option>
          </select>
        </div>
        <div class="flex-1 min-w-[200px]">
          <select id="difficulty-filter" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-purple-500">
            <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
            <option value="beginner">–ù–∞—á–∞–ª—å–Ω—ã–π</option>
            <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
            <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
          </select>
        </div>
        <div class="flex-1 min-w-[200px]">
          <select id="duration-filter" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-purple-500">
            <option value="all">–õ—é–±–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</option>
            <option value="short">–î–æ 10 –º–∏–Ω—É—Ç</option>
            <option value="medium">10-30 –º–∏–Ω—É—Ç</option>
            <option value="long">–ë–æ–ª–µ–µ 30 –º–∏–Ω—É—Ç</option>
          </select>
        </div>
      </div>
    </div>

    <!-- –°–µ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤ -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="test-grid">
      <!-- –¢–µ—Å—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
      <div class="animate-pulse">
        <div class="bg-gray-800 rounded-lg p-6">
          <div class="h-4 bg-gray-700 rounded w-3/4 mb-4"></div>
          <div class="h-4 bg-gray-700 rounded w-1/2 mb-2"></div>
          <div class="h-4 bg-gray-700 rounded w-1/4"></div>
        </div>
      </div>
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    <div class="mt-8 flex justify-center space-x-2">
      <button id="prev-page" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed">
        –ù–∞–∑–∞–¥
      </button>
      <div id="page-numbers" class="flex space-x-2">
        <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
      </div>
      <button id="next-page" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed">
        –í–ø–µ—Ä—ë–¥
      </button>
    </div>
  </main>

  <footer class="text-center text-gray-500 text-sm p-4 border-t border-gray-700 mt-12">
    <p data-i18n="footer_text">¬© 2025 Soulware. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script>
    // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤
    const tests = [
      { 
        id: 1, 
        title: { en: "Archetype Mirror", ru: "–ó–µ—Ä–∫–∞–ª–æ –ê—Ä—Ö–µ—Ç–∏–ø–æ–≤" },
        description: { 
          en: "Discover your dominant archetypes and their influence on your life",
          ru: "–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–∏ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø—ã –∏ –∏—Ö –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞—à—É –∂–∏–∑–Ω—å"
        },
        category: "archetype",
        difficulty: "intermediate",
        duration: "medium",
        premium: true,
        image: "https://placekitten.com/300/200"
      },
      { 
        id: 2, 
        title: { en: "Shadow Integration", ru: "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¢–µ–Ω–∏" },
        description: {
          en: "Explore and understand your shadow aspects",
          ru: "–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –∏ –ø–æ–π–º–∏—Ç–µ –∞—Å–ø–µ–∫—Ç—ã –≤–∞—à–µ–π –¢–µ–Ω–∏"
        },
        category: "shadow",
        difficulty: "advanced",
        duration: "long",
        premium: true,
        image: "https://placekitten.com/301/200"
      },
      { 
        id: 3, 
        title: { en: "Mythological Heroes", ru: "–ì–µ—Ä–æ–∏ –ú–∏—Ñ–æ–≤" },
        description: {
          en: "Which mythological hero resonates with your journey?",
          ru: "–ö–∞–∫–æ–π –º–∏—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –≥–µ—Ä–æ–π —Å–æ–∑–≤—É—á–µ–Ω –≤–∞—à–µ–º—É –ø—É—Ç–∏?"
        },
        category: "myth",
        difficulty: "beginner",
        duration: "short",
        premium: false,
        image: "https://placekitten.com/302/200"
      }
    ];

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    let state = {
      currentPage: 1,
      itemsPerPage: 9,
      filters: {
        category: 'all',
        difficulty: 'all',
        duration: 'all',
        search: ''
      }
    };

    // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–µ—Å—Ç–æ–≤
    function renderTests() {
      const container = document.getElementById('test-grid');
      const lang = localStorage.getItem('lang') || 'ru';
      
      // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
      let filteredTests = tests.filter(test => {
        const matchesCategory = state.filters.category === 'all' || test.category === state.filters.category;
        const matchesDifficulty = state.filters.difficulty === 'all' || test.difficulty === state.filters.difficulty;
        const matchesDuration = state.filters.duration === 'all' || test.duration === state.filters.duration;
        const matchesSearch = test.title[lang].toLowerCase().includes(state.filters.search.toLowerCase()) ||
                            test.description[lang].toLowerCase().includes(state.filters.search.toLowerCase());
        
        return matchesCategory && matchesDifficulty && matchesDuration && matchesSearch;
      });

      // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
      const start = (state.currentPage - 1) * state.itemsPerPage;
      const paginatedTests = filteredTests.slice(start, start + state.itemsPerPage);

      // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
      container.innerHTML = '';

      // –†–µ–Ω–¥–µ—Ä–∏–º —Ç–µ—Å—Ç—ã
      paginatedTests.forEach(test => {
        const card = document.createElement('div');
        card.className = 'bg-gray-800 rounded-lg overflow-hidden hover:bg-gray-750 transition-colors';
        
        card.innerHTML = `
          <img src="${test.image}" alt="${test.title[lang]}" class="w-full h-48 object-cover">
          <div class="p-6">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-xl font-semibold">${test.title[lang]}</h3>
              ${test.premium ? '<span class="text-purple-400">üëë Premium</span>' : ''}
            </div>
            <p class="text-gray-400 mb-4">${test.description[lang]}</p>
            <div class="flex items-center justify-between">
              <div class="flex space-x-2">
                <span class="text-sm text-gray-500">${getDifficultyLabel(test.difficulty, lang)}</span>
                <span class="text-sm text-gray-500">‚Ä¢</span>
                <span class="text-sm text-gray-500">${getDurationLabel(test.duration, lang)}</span>
              </div>
              <button onclick="startTest(${test.id})" 
                      class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors">
                –ù–∞—á–∞—Ç—å
              </button>
            </div>
          </div>
        `;

        container.appendChild(card);
      });

      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
      updatePagination(filteredTests.length);
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function getDifficultyLabel(difficulty, lang) {
      const labels = {
        beginner: { ru: "–ù–∞—á–∞–ª—å–Ω—ã–π", en: "Beginner" },
        intermediate: { ru: "–°—Ä–µ–¥–Ω–∏–π", en: "Intermediate" },
        advanced: { ru: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π", en: "Advanced" }
      };
      return labels[difficulty][lang];
    }

    function getDurationLabel(duration, lang) {
      const labels = {
        short: { ru: "–î–æ 10 –º–∏–Ω", en: "Under 10 min" },
        medium: { ru: "10-30 –º–∏–Ω", en: "10-30 min" },
        long: { ru: "30+ –º–∏–Ω", en: "30+ min" }
      };
      return labels[duration][lang];
    }

    function updatePagination(totalItems) {
      const totalPages = Math.ceil(totalItems / state.itemsPerPage);
      const container = document.getElementById('page-numbers');
      container.innerHTML = '';

      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
      for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement('button');
        button.className = `px-4 py-2 rounded-lg ${
          i === state.currentPage ? 'bg-purple-600' : 'bg-gray-800 hover:bg-gray-700'
        }`;
        button.textContent = i;
        button.onclick = () => {
          state.currentPage = i;
          renderTests();
        };
        container.appendChild(button);
      }

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
      document.getElementById('prev-page').disabled = state.currentPage === 1;
      document.getElementById('next-page').disabled = state.currentPage === totalPages;
    }

    function startTest(testId) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
      if (!window.auth.isAuthenticated) {
        window.location.href = `/login.html?redirect=test.html?id=${testId}`;
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å
      const test = tests.find(t => t.id === testId);
      if (test.premium && !window.auth.user?.isPremium) {
        window.location.href = '/subscribe.html';
        return;
      }

      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ç–µ—Å—Ç—É
      window.location.href = `/test.html?id=${testId}`;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', () => {
      // –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
      document.getElementById('mobile-menu-button').addEventListener('click', () => {
        document.getElementById('mobile-menu').classList.toggle('hidden');
      });

      // –ü–æ–∏—Å–∫
      let searchTimeout;
      document.getElementById('search-input').addEventListener('input', (e) => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          state.filters.search = e.target.value;
          state.currentPage = 1;
          renderTests();
        }, 300);
      });

      // –§–∏–ª—å—Ç—Ä—ã
      ['category', 'difficulty', 'duration'].forEach(filter => {
        document.getElementById(`${filter}-filter`).addEventListener('change', (e) => {
          state.filters[filter] = e.target.value;
          state.currentPage = 1;
          renderTests();
        });
      });

      // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
      document.getElementById('prev-page').addEventListener('click', () => {
        if (state.currentPage > 1) {
          state.currentPage--;
          renderTests();
        }
      });

      document.getElementById('next-page').addEventListener('click', () => {
        const totalPages = Math.ceil(tests.length / state.itemsPerPage);
        if (state.currentPage < totalPages) {
          state.currentPage++;
          renderTests();
        }
      });

      // –ü–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä
      renderTests();
    });
  </script>
</body>
</html>
